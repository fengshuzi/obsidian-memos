# 任务支持功能更新

## 更新内容

本次更新为 obsidian-memos 插件添加了完整的任务格式支持，现在所有任务格式都会被识别为闪念笔记并显示对应的状态。

## 新增功能

### 1. 支持的任务格式

#### 复选框格式
- `- [ ] 13:33 test` - 未完成的任务（带时间戳）
- `- [x] 14:00 完成的任务` - 已完成的任务（带时间戳）
- `- [ ] 未完成的任务` - 未完成的任务（无时间戳）
- `- [x] 完成的任务` - 已完成的任务（无时间戳）

#### 任务关键词格式
- `- TODO 15:00 待办事项` - 待办（带时间戳）
- `- DOING 15:30 正在进行` - 进行中（带时间戳）
- `- DONE 16:00 已完成` - 已完成（带时间戳）
- `- NOW 16:30 立即执行` - 立即执行（带时间戳）
- `- LATER 17:00 稍后处理` - 稍后处理（带时间戳）
- `- WAITING 17:30 等待中` - 等待中（带时间戳）
- `- CANCELLED 18:00 已取消` - 已取消（带时间戳）
- 以上格式也支持不带时间戳的版本

### 2. 任务状态渲染

在闪念视图中，任务会显示：

#### 状态图标
- ☐ 未完成复选框
- ☑ 已完成复选框
- 📝 TODO
- ⚡ DOING
- ✅ DONE
- 🔥 NOW
- ⏰ LATER
- ⏳ WAITING
- ❌ CANCELLED

#### 彩色边框
- 灰色：未完成复选框
- 绿色：已完成复选框、DONE
- 蓝色：TODO
- 橙色：DOING
- 红色：NOW
- 紫色：LATER
- 青色：WAITING
- 灰色：CANCELLED

#### 视觉效果
- 已完成和已取消的任务显示为半透明
- 已取消的任务带有删除线
- 任务卡片左侧有 3px 宽的彩色边框标识

## 技术实现

### 修改的文件

1. **src/types.ts**
   - 添加 `TaskStatus` 类型定义
   - 添加任务格式的正则表达式
   - 在 `MemoItem` 接口中添加 `taskStatus` 字段

2. **src/storage.ts**
   - 更新 `parseMemoLine` 方法，支持解析复选框和任务关键词格式
   - 优先匹配任务格式，然后匹配普通闪念格式

3. **src/MemosView.ts**
   - 更新 `renderMemoCard` 方法，渲染任务状态图标
   - 添加 `getTaskStatusIcon` 方法，返回对应的状态图标
   - 为任务卡片添加特殊的 CSS 类

4. **styles.css**
   - 添加任务卡片的样式
   - 为不同任务状态定义彩色边框
   - 添加已完成和已取消任务的视觉效果

## 使用示例

在 journals 文件中添加以下内容：

```markdown
- [ ] 13:33 完成项目报告
- TODO 14:00 #工作 回复邮件
- DOING 15:00 #学习 学习 TypeScript
- [x] 16:00 #健身 跑步 5 公里
- DONE 17:00 完成代码审查
```

这些任务都会在闪念视图中显示，并带有对应的状态图标和彩色边框。

## 兼容性

- 完全向后兼容，不影响现有的闪念笔记格式
- 支持任务格式带标签
- 支持任务格式带或不带时间戳
- 与 Obsidian 原生任务格式兼容

## 测试

可以使用 `TEST_TASKS.md` 文件测试所有支持的任务格式。
